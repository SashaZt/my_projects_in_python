# Полное руководство: создание записи в WordPress через REST API с JWT аутентификацией

---

## **1. Настройка WordPress**

### Установка и активация плагина JWT Authentication
1. Войдите в админ-панель WordPress.
2. Перейдите в раздел **Плагины** → **Добавить новый**.
3. В строке поиска введите **JWT Authentication for WP REST API**.
4. Нажмите **Установить**, а затем **Активировать** плагин.

### Настройка JWT в файле `wp-config.php`
1. Найдите файл `wp-config.php` на вашем сервере. Этот файл расположен в корневой папке сайта WordPress.
2. Добавьте перед строкой `/* That's all, stop editing! Happy publishing. */` следующий код:
   ```php
   define('JWT_AUTH_SECRET_KEY', 'your-secret-key'); // Уникальный секретный ключ
   define('JWT_AUTH_CORS_ENABLE', true);
   ```
3. Сохраните изменения и загрузите файл обратно на сервер.

### Проверьте наличие SSL-сертификата
JWT аутентификация требует HTTPS для безопасной работы. Если HTTPS ещё не настроен, установите SSL-сертификат через панель хостинга (например, с помощью Let’s Encrypt).

---

## **2. Создание пользователя**

### Проверка существующих пользователей
1. В админ-панели WordPress перейдите в раздел **Пользователи** → **Все пользователи**.
2. Убедитесь, что у вас есть пользователь с ролью `Administrator` или `Editor`.

### Создание нового пользователя (если требуется)
1. Перейдите в раздел **Пользователи** → **Добавить нового**.
2. Заполните форму:
   - **Имя пользователя:**, например, `apiuser`.
   - **Электронная почта:** укажите рабочий email.
   - **Пароль:** задайте сложный пароль.
   - **Роль:** выберите `Administrator` или `Editor`.
3. Нажмите **Добавить нового пользователя**.

---

## **3. Получение JWT токена**

### Выполнение запроса для получения токена
Используйте Postman, curl или Python для выполнения запроса. Пример команды с `curl`:
```bash
curl -X POST https://your-site.com/wp-json/jwt-auth/v1/token \
-H "Content-Type: application/json" \
-d '{
    "username": "apiuser",
    "password": "your-password"
}'
```

### Проверка ответа
Если запрос выполнен успешно, вы получите токен в формате JSON:
```json
{
    "success": true,
    "data": {
        "token": "your-jwt-token",
        "user_email": "apiuser@example.com"
    }
}
```
Этот токен используется для авторизации в дальнейших запросах.

---

## **4. Создание записи**

### Отправка POST-запроса
С помощью полученного токена создайте запись. Пример команды:
```bash
curl -X POST https://your-site.com/wp-json/wp/v2/posts \
-H "Authorization: Bearer your-jwt-token" \
-H "Content-Type: application/json" \
-d '{
    "title": "Новая запись",
    "content": "Это содержимое записи.",
    "status": "publish"
}'
```

### Проверка результата
После выполнения запроса вы получите ответ с данными о созданной записи. Пример ответа:
```json
{
    "id": 123,
    "link": "https://your-site.com/2024/12/26/новая-запись/"
}
```
ID записи можно использовать для её редактирования или удаления.

---

## **5. Дополнительные действия**

### Обновление записи
Для изменения существующей записи выполните PUT или PATCH запрос:
```bash
curl -X PUT https://your-site.com/wp-json/wp/v2/posts/123 \
-H "Authorization: Bearer your-jwt-token" \
-H "Content-Type: application/json" \
-d '{
    "title": "Обновленный заголовок",
    "content": "Обновленное содержимое."
}'
```

### Удаление записи
Чтобы удалить запись, выполните DELETE запрос с её ID:
```bash
curl -X DELETE https://your-site.com/wp-json/wp/v2/posts/123 \
-H "Authorization: Bearer your-jwt-token"
```

### Добавление изображений
Чтобы прикрепить изображение к записи:
1. Загрузите файл через `/wp-json/wp/v2/media`.
2. Используйте ID загруженного файла в поле `featured_media` записи.

---

## **6. Рекомендации по безопасности**

### Защита токенов
- Храните токены в безопасном месте.
- Никогда не передавайте токены через ненадёжные каналы.

### Минимизация прав
- Используйте пользователей с минимально необходимыми правами (например, `Editor`, если `Administrator` не требуется).

### Мониторинг активности
- Регулярно проверяйте журналы запросов REST API и активности пользователей.

---

С этой инструкцией вы сможете настроить REST API WordPress и эффективно работать с созданием записей через API.

