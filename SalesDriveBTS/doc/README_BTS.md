# Документация по API клиенту BTS.uz

## Описание

Данный API клиент предназначен для работы с сервисом BTS.uz и предоставляет функциональность для авторизации и создания заявок.

## Обязательные поля для создания заявки

Основываясь на официальной документации API, следующие поля являются обязательными для создания заявки:

| Параметр | Описание                       | Тип    | Пример значения            |
| ---------------- | -------------------------------------- | --------- | ---------------------------------------- |
| senderCityId     | ID города отправителя | int       | 3                                        |
| senderAddress    | Адрес отправителя      | str       | "г.Ташкент,ул.Бобур,5-А" |
| senderReal       | ФИО отправителя          | str       | "Jurabek Turdiyev"                       |
| senderPhone      | Телефон отправителя  | str       | "+998 99 1234567"                        |
| weight           | Вес отправления в кг  | float/int | 2                                        |
| packageId        | ID типа упаковки           | int       | 4                                        |
| postTypeId       | ID типа отправления     | int       | 16                                       |
| receiver         | ФИО получателя            | str       | "Odil Ahkmedov"                          |
| receiverAddress  | Адрес получателя        | str       | "Гозо зима. 41 дом"           |
| receiverCityId   | ID города получателя   | int       | 3                                        |
| receiverPhone    | Телефон получателя    | str       | "+998 99 1234567"                        |

## Условно-обязательные поля

| Параметр   | Описание                                 | Тип | Пример значения | Условие                                        |
| ------------------ | ------------------------------------------------ | ------ | ----------------------------- | ----------------------------------------------------- |
| receiver_branch_id | ID филиала получателя           | int    | 93                            | Обязательно, если receiverDelivery = 0 |
| back_money         | Сумма наложенного платежа | int    | 100000                        | Обязательно, если bringBackMoney = 1   |

## Необязательные поля для создания заявки

| Параметр | Описание                                                    | Тип    | Пример значения | По умолчанию |
| ---------------- | ------------------------------------------------------------------- | --------- | ----------------------------- | ----------------------- |
| senderDelivery   | Вызов курьера (1) или самовывоз (0)         | int       | 1                             | 0                       |
| receiverDelivery | Доставка курьером (1) или самовывоз (0) | int       | 1                             | 0                       |
| clientId         | Штрих-код клиента                                    | str       | "abc123mn12"                  | None                    |
| wcs_code         | Уникальный код заказа                            | str       | "900001"                      | None                    |
| volume           | Объем (длина*высота*ширина)                 | float/int | 0                             | 0                       |
| takePhoto        | Фотографировать (1 - да, 0 - нет)               | int       | 1                             | 0                       |
| is_test          | Тестовый режим (1 - да, 0 - нет)                  | int       | 0                             | 0                       |
| piece            | Количество мест                                       | int       | 1                             | 1                       |
| senderDate       | Дата отправки (YYYY-MM-DD)                              | str       | "2023-04-14"                  | Текущая дата |
| receiverDate     | Дата получения (YYYY-MM-DD)                            | str       | "2023-04-15"                  | Текущая дата |
| receiverPhone1   | Дополнительный телефон получателя    | str       | "+998 99 1234568"             | None                    |
| bringBackMoney   | Наложенный платеж (1 - да, 0 - нет)            | int       | 1                             | 0                       |
| bringBackWaybill | Возврат документа (1 - да, 0 - нет)            | int       | 1                             | 0                       |
| postTypes        | Список типов посылок                              | list      | см. ниже                | None                    |
| options          | Дополнительные опции                             | list      | см. ниже                | None                    |

## Дополнительные параметры

### postTypes - Типы посылок

Массив объектов, каждый из которых содержит:

```json
{
    "name": "Название товара",
    "code": "Код товара",
    "count": Количество
}
```

### options - Опции

Используется для получения электронного кассового чека (необходимо для наложенного платежа):

```json
{
    "optionId": 2, // 2 - Получить электронный кассовый чек
    "goods": [
        {
            "mxikGoodsId": 71, // ID товара из списка продуктов
            "amount": 1, // Количество 
            "goodPrice": 700000 // Цена за единицу в сумах
        }
    ]
}
```

## Особые условия и проверки

1. Если `receiverDelivery = 0` (получатель забирает сам), то обязательно указать `receiver_branch_id` (ID филиала).
2. Если `bringBackMoney = 1` (наложенный платеж), то обязательно указать `back_money` (сумму).
3. При наложенном платеже рекомендуется использовать опцию для электронного кассового чека (optionId: 2).

## Пример успешного ответа

При успешном создании заявки API возвращает подробную информацию, включая:

* orderId: ID созданной заявки
* barcode: Штрих-код отправления
* tracking: URL для отслеживания
* labelEncode и labelSticker: URL для печати этикеток
* Дополнительную информацию о отправителе, получателе, отделениях и т.д.

## Пример обработки ошибок

В случае ошибок валидации API возвращает JSON с полем "errors", где перечислены ошибки по каждому полю.
Клиент автоматически обрабатывает и выводит эти ошибки.
